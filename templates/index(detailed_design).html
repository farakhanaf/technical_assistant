<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Technical Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Detailed Design -->

<style>
:root {
  --glass-bg: rgba(15, 23, 42, 0.55);
  --glass-border: rgba(255,255,255,0.12);
  --text-main: #e5e7eb;
  --text-muted: #94a3b8;
  --accent: #38bdf8;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  /* background: url("/static/bg.jpg") center / cover no-repeat fixed; */
  background-image: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-main);
}

/* Glass Panel */
.panel {
  width: 380px;
  padding: 18px;
  border-radius: 22px;
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  box-shadow: 0 30px 60px rgba(0,0,0,0.45);
}

/* Header */
.header {
  margin-bottom: 16px;
}

.header h1 {
  font-size: 1.2rem;
  margin: 0;
}

.header .subtitle {
  font-size: 0.8rem;
  color: var(--text-muted);
}

/* Section */
.section {
  margin-top: 14px;
}

.section-title {
  font-size: 0.75rem;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 8px;
}

/* Item Row */
.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 12px;
  border-radius: 14px;
  margin-bottom: 6px;
  transition: background 0.2s ease;
}

.item:hover {
  background: rgba(255,255,255,0.06);
}

.label {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.value {
  font-size: 0.85rem;
  font-weight: 500;
}

/* Status colors */
.ok { color: #22c55e; }
.warn { color: #facc15; }
.crit { color: #ef4444; }

/* Footer */
.footer {
  margin-top: 18px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.8rem;
  color: var(--text-muted);
}

.avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: linear-gradient(135deg,#38bdf8,#6366f1);
}
</style>
</head>

<body>

<div class="panel">

  <!-- HEADER -->
  <div class="header">
    <h1>ðŸ–¥ {{ system.hostname }}</h1>
    <div class="subtitle">
      {{ system.os }} â€¢ {{ system.architecture }}
    </div>
  </div>

  <!-- SYSTEM -->
  <div class="section">
    <div class="section-title">System</div>
    <div class="item">
      <span class="label">User</span>
      <span class="value">{{ system.current_user }}</span>
    </div>
    <div class="item">
      <span class="label">Processor</span>
      <span class="value">{{ system.processor }}</span>
    </div>
    <div class="item">
      <span class="label">Uptime</span>
      <span id="uptime" class="value">{{ system.uptime }}</span>
    </div>
  </div>

  <!-- CPU -->
  <div class="section">
    <div class="section-title">CPU</div>
    <div class="item">
      <span class="label">Usage</span>
      <span id="cpu_usage"
        class="value {{ 'crit' if cpu.usage_total > 85 else 'warn' if cpu.usage_total > 65 else 'ok' }}">
        {{ cpu.usage_total }} %
      </span>
    </div>
    <div class="item">
      <span class="label">Frequency</span>
      <span class="value">{{ cpu.frequency_current }} MHz</span>
    </div>
    {% for c in cpu.usage_per_core %}
    <div class="item">
      <span class="label">Core {{ loop.index }}</span>
      <span class="value">{{ c }}%</span>
    </div>
    {% endfor %}
  </div>

  <!-- MEMORY -->
  <div class="section">
    <div class="section-title">Memory</div>
    <div class="item">
      <span class="label">Used</span>
      <span class="value">{{ memory.ram_used }} / {{ memory.ram_total }} GB</span>
    </div>
    <div class="item">
      <span class="label">Available</span>
      <span id="ram_available"
        class="value {{ 'crit' if memory.ram_available < 1 else 'warn' if memory.ram_available < 2 else 'ok' }}">
        {{ memory.ram_available }} GB
      </span>
    </div>
    <div class="item">
      <span class="label">Swap</span>
      <span class="value">{{ memory.swap_used }} GB</span>
    </div>
  </div>

  <!-- STORAGE -->
  <div class="section">
    <div class="section-title">Storage</div>
    {% for d in disks %}
    <div class="item">
      <span class="label">{{ d.device }}</span>
      <span class="value {{ 'crit' if (d.used / d.total * 100) > 90 else 'warn' if (d.used / d.total * 100) > 75 else 'ok' }}">
        {{ d.used }} / {{ d.total }} GB
      </span>
    </div>
    {% endfor %}
  </div>

  <!-- DISK I/O -->
  <div class="section">
    <div class="section-title">Disk I/O</div>
    <div class="item">
      <span class="label">Read</span>
      <span class="value">{{ disk_io.read_gb }} GB</span>
    </div>
    <div class="item">
      <span class="label">Write</span>
      <span class="value">{{ disk_io.write_gb }} GB</span>
    </div>
  </div>

  <!-- NETWORK -->
  <div class="section">
    <div class="section-title">Network</div>
    <div class="item">
      <span class="label">Sent</span>
      <span class="value">{{ network.bytes_sent_mb }} MB</span>
    </div>
    <div class="item">
      <span class="label">Received</span>
      <span class="value">{{ network.bytes_recv_mb }} MB</span>
    </div>
  </div>

  <!-- BATTERY -->
  {% if battery %}
  <div class="section">
    <div class="section-title">Battery</div>
    <div class="item">
      <span class="label">Charge</span>
      <span id="battery_percent"
        class="value {{ 'crit' if battery.percent < 20 else 'warn' if battery.percent < 40 else 'ok' }}">
        {{ battery.percent }}%
      </span>
    </div>
    <div class="item">
      <span class="label">Status</span>
      <span class="value">{{ "Charging" if battery.plugged else "Discharging" }}</span>
    </div>
    <div class="item">
      <span class="label">Time Left</span>
      <span id="battery_time" class="value">{{ battery.time_left }}</span>
    </div>
  </div>
  {% endif %}

  <!-- TOP PROCESSES -->
  <div class="section">
    <div class="section-title">Top Processes</div>
    {% for p in processes %}
    <div class="item">
      <span class="label">{{ p.name }} (PID {{ p.pid }})</span>
      <span class="value">CPU {{ p.cpu_percent }}% | RAM {{ "%.2f"|format(p.memory_percent) }}%</span>
    </div>
    {% endfor %}
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <div class="avatar"></div>
    <div>Technical Assistant</div>
  </div>

</div>

<script>
async function refreshStatus() {
  try {
    const res = await fetch("/api/status");
    const data = await res.json();

    // SYSTEM
    document.getElementById("uptime").innerText = data.system.uptime;

    // CPU
    document.getElementById("cpu_usage").innerText =
      data.cpu.usage_total + " %";

    // MEMORY
    document.getElementById("ram_available").innerText =
      data.memory.ram_available + " GB";

    // BATTERY (jika ada)
    if (data.battery) {
      document.getElementById("battery_percent").innerText =
        data.battery.percent + "%";
      document.getElementById("battery_time").innerText =
        data.battery.time_left;
    }

  } catch (err) {
    console.error("Status refresh failed", err);
  }
}

// refresh tiap 5 detik
setInterval(refreshStatus, 5000);

// refresh pertama kali langsung
refreshStatus();
</script>

</body>
</html>